(function(f,m,s,i){var a="bootstrapDualListbox",n={bootstrap2Compatible:false,filterTextClear:"show all",filterPlaceHolder:"Filter",moveSelectedLabel:"Move selected",moveAllLabel:"Move all",removeSelectedLabel:"Remove selected",removeAllLabel:"Remove all",moveOnSelect:true,moveOnDoubleClick:true,preserveSelectionOnMove:false,selectedListLabel:false,nonSelectedListLabel:false,helperSelectNamePostfix:"_helper",selectorMinimalHeight:100,showFilterInputs:true,nonSelectedFilter:"",selectedFilter:"",infoText:"Showing all {0}",infoTextFiltered:'<span class="label label-warning">Filtered</span> {0} from {1}',infoTextEmpty:"Empty list",filterOnValues:false,sortByInputOrder:false,eventMoveOverride:false,eventMoveAllOverride:false,eventRemoveOverride:false,eventRemoveAllOverride:false},r=/android/i.test(navigator.userAgent.toLowerCase());function p(z,y){this.element=f(z);this.settings=f.extend({},n,y);this._defaults=n;this._name=a;this.init()}function x(z){z.element.trigger("change");z.element.nextAll().remove();var y=[];z.element.find("option[data-sortindex]:selected").each(function(A,B){y[f(B).attr("data-sortindex")]=f(B).attr("value")});if(y.length){f.each(y,function(B,A){if(A!==i){z.element.parent().append('<input type="hidden" name="'+z.element.attr("name")+'" value="'+A+'" />')}})}else{z.element.parent().append('<input type="hidden" name="'+z.element.attr("name")+'" value="" />')}}function h(y){y.element.find("option").each(function(A,B){var z=f(B);if(typeof(z.data("original-index"))==="undefined"){z.data("original-index",y.elementCount++)}if(typeof(z.data("_selected"))==="undefined"){z.data("_selected",false)}})}function q(y,A,z){y.element.find("option").each(function(C,D){var B=f(D);if(B.data("original-index")===A){B.prop("selected",z);if(z){B.attr("data-sortindex",y.sortIndex);y.sortIndex++}else{B.removeAttr("data-sortindex")}}})}function j(z,y){return z.replace(/\{(\d+)\}/g,function(A,B){return typeof y[B]!=="undefined"?y[B]:A})}function w(y){if(!y.settings.infoText){return}var D=y.elements.select1.find("option").length,C=y.elements.select2.find("li").length,A=y.element.find("option").length-y.selectedElements,z=y.selectedElements,B="";if(A===0){B=y.settings.infoTextEmpty}else{if(D===A){B=j(y.settings.infoText,[D,A])}else{B=j(y.settings.infoTextFiltered,[D,A])}}y.elements.info1.html(B);y.elements.box1.toggleClass("filtered",!(D===A||A===0));if(z===0){B=y.settings.infoTextEmpty}else{if(C===z){B=j(y.settings.infoText,[C,z])}else{B=j(y.settings.infoTextFiltered,[C,z])}}y.elements.info2.html(B);y.elements.box2.toggleClass("filtered",!(C===z||z===0))}function b(y){y.selectedElements=0;y.elements.select1.empty();var z={};y.elements.select2.find("li").each(function(A,B){z[f(B).attr("value")]=f(B).attr("data-sortindex")});y.elements.select2.empty();y.element.find("option").each(function(B,D){var A=f(D);if(A.prop("selected")){y.selectedElements++;var C=f(A.clone(true).get(0).outerHTML.replace(/^<option/,"<li").replace(/\/option>$/,"/li>")).appendTo(y.elements.select2).data("original-index",A.data("original-index"));A.data("_selected")?C.addClass("selected"):C.removeClass("selected");if(z[f(D).val()]!=="undefined"){C.attr("data-sortindex",z[f(D).val()])}}else{y.elements.select1.append(A.clone(true).prop("selected",A.data("_selected")))}});if(y.settings.showFilterInputs){o(y,1);o(y,2)}w(y)}function o(y,A){if(!y.settings.showFilterInputs){return}g(y,A);if(A===2){var z={};y.elements.select2.find("li").each(function(E,F){z[f(F).attr("value")]=f(F).attr("data-sortindex")})}y.elements["select"+A].empty().scrollTop(0);var C=new RegExp(f.trim(y.elements["filterInput"+A].val()),"gi"),D=y.element.find("option"),B=y.element;if(A===1){B=D.not(":selected")}else{B=B.find("option:selected")}B.each(function(G,I){var F=f(I),E=true;if(I.text.match(C)||(y.settings.filterOnValues&&F.attr("value").match(C))){E=false;if(A==1){y.elements["select"+A].append(F.clone(true).prop("selected",F.data("_selected")))}else{var H=f(F.clone(true).get(0).outerHTML.replace(/^<option/,"<li").replace(/\/option>$/,"/li>")).appendTo(y.elements["select"+A]).data("original-index",F.data("original-index"));F.data("_selected")?H.addClass("selected"):H.removeClass("selected");if(z[f(I).val()]!=="undefined"){H.attr("data-sortindex",z[f(I).val()])}}}D.eq(F.data("original-index")).data("filtered"+A,E)});w(y)}function g(y,z){var A=y.element.find("li");y.elements["select"+z].find(z==1?"option":"li").each(function(C,D){var B=f(D);A.eq(B.data("original-index")).data("_selected",z==1?B.prop("selected"):B.hasClass("selected"))})}function k(y){var z=y.children(y.tagName=="SELECT"?"option":"li");z.sort(function(B,A){var C=parseInt(B.getAttribute("data-sortindex")),D=parseInt(A.getAttribute("data-sortindex"));if(C>D){return 1}if(C<D){return -1}return 0});z.detach().appendTo(y)}function v(y){y.find(y.tagName=="SELECT"?"option":"li").sort(function(A,z){return(f(A).data("original-index")>f(z).data("original-index"))?1:-1}).appendTo(y)}function e(y){y.elements.select1.find("option").each(function(){y.element.find("option").data("_selected",false)})}function t(y){if(y.settings.preserveSelectionOnMove==="all"&&!y.settings.moveOnSelect){g(y,1);g(y,2)}else{if(y.settings.preserveSelectionOnMove==="moved"&&!y.settings.moveOnSelect){g(y,1)}}y.elements.select1.find("option:selected").each(function(A,B){var z=f(B);if(!z.data("filtered1")){q(y,z.data("original-index"),true)}});b(y);x(y);if(y.settings.sortByInputOrder){k(y.elements.select2)}else{v(y.elements.select2)}}function u(y){if(y.settings.preserveSelectionOnMove==="all"&&!y.settings.moveOnSelect){g(y,1);g(y,2)}else{if(y.settings.preserveSelectionOnMove==="moved"&&!y.settings.moveOnSelect){g(y,2)}}y.elements.select2.find("li.selected").each(function(A,B){var z=f(B);if(!z.data("filtered2")){q(y,z.data("original-index"),false)}});b(y);x(y);v(y.elements.select1);if(y.settings.sortByInputOrder){k(y.elements.select2)}}function l(y){if(y.settings.preserveSelectionOnMove==="all"&&!y.settings.moveOnSelect){g(y,1);g(y,2)}else{if(y.settings.preserveSelectionOnMove==="moved"&&!y.settings.moveOnSelect){g(y,1)}}y.element.find("option").each(function(A,B){var z=f(B);if(!z.data("filtered1")){z.prop("selected",true);z.attr("data-sortindex",y.sortIndex);y.sortIndex++}});b(y);x(y)}function d(y){if(y.settings.preserveSelectionOnMove==="all"&&!y.settings.moveOnSelect){g(y,1);g(y,2)}else{if(y.settings.preserveSelectionOnMove==="moved"&&!y.settings.moveOnSelect){g(y,2)}}y.element.find("option").each(function(A,B){var z=f(B);if(!z.data("filtered2")){z.prop("selected",false);z.removeAttr("data-sortindex")}});b(y);x(y)}function c(y){y.elements.form.submit(function(z){if(y.elements.filterInput1.is(":focus")){z.preventDefault();y.elements.filterInput1.focusout()}else{if(y.elements.filterInput2.is(":focus")){z.preventDefault();y.elements.filterInput2.focusout()}}});y.element.on("bootstrapDualListbox.refresh",function(z,A){y.refresh(A)});y.elements.filterClear1.on("click",function(){y.setNonSelectedFilter("",true)});y.elements.filterClear2.on("click",function(){y.setSelectedFilter("",true)});if(y.settings.eventMoveOverride===false){y.elements.moveButton.on("click",function(){t(y)})}if(y.settings.eventMoveAllOverride===false){y.elements.moveAllButton.on("click",function(){l(y)})}if(y.settings.eventRemoveOverride===false){y.elements.removeButton.on("click",function(){u(y)})}if(y.settings.eventRemoveAllOverride===false){y.elements.removeAllButton.on("click",function(){d(y)})}y.elements.filterInput1.on("change keyup",function(){o(y,1)});y.elements.filterInput2.on("change keyup",function(){o(y,2)});y.elements.select2.delegate("li","click",function(){y.elements.select2.find("li").removeClass("selected");f(this).addClass("selected")});Sortable.create(y.elements.select2.get(0),{onUpdate:function(z){y.elements.select2.find("li").each(function(A,B){f(B).attr("data-sortindex",A);y.element.find("option[value="+f(B).attr("value")+"]").attr("data-sortindex",A)});x(y)}})}p.prototype={init:function(){this.container=f('<div class="bootstrap-duallistbox-container"> <div class="box1">   <label></label>   <span class="info-container">     <span class="info"></span>     <button type="button" class="btn clear1 pull-right"></button>   </span>   <input class="filter" type="text">   <div class="btn-group buttons">     <button type="button" class="btn moveall">       <i></i>       <i></i>     </button>     <button type="button" class="btn move">       <i></i>     </button>   </div>   <select multiple="multiple"></select> </div> <div class="box2">   <label></label>   <span class="info-container">     <span class="info"></span>     <button type="button" class="btn clear2 pull-right"></button>   </span>   <input class="filter" type="text">   <div class="btn-group buttons">     <button type="button" class="btn remove">       <i></i>     </button>     <button type="button" class="btn removeall">       <i></i>       <i></i>     </button>   </div>   <ul></ul> </div></div>').insertBefore(this.element);this.elements={originalSelect:this.element,box1:f(".box1",this.container),box2:f(".box2",this.container),filterInput1:f(".box1 .filter",this.container),filterInput2:f(".box2 .filter",this.container),filterClear1:f(".box1 .clear1",this.container),filterClear2:f(".box2 .clear2",this.container),label1:f(".box1 > label",this.container),label2:f(".box2 > label",this.container),info1:f(".box1 .info",this.container),info2:f(".box2 .info",this.container),select1:f(".box1 select",this.container),select2:f(".box2 ul",this.container),moveButton:f(".box1 .move",this.container),removeButton:f(".box2 .remove",this.container),moveAllButton:f(".box1 .moveall",this.container),removeAllButton:f(".box2 .removeall",this.container),form:f(f(".box1 .filter",this.container)[0].form)};this.originalSelectName=this.element.attr("name")||"";var z="bootstrap-duallistbox-nonselected-list_"+this.originalSelectName,y="bootstrap-duallistbox-selected-list_"+this.originalSelectName;this.elements.select1.attr("id",z);this.elements.select2.attr("id",y);this.elements.label1.attr("for",z);this.elements.label2.attr("for",y);this.selectedElements=0;this.sortIndex=0;this.elementCount=0;this.setBootstrap2Compatible(this.settings.bootstrap2Compatible);this.setFilterTextClear(this.settings.filterTextClear);this.setFilterPlaceHolder(this.settings.filterPlaceHolder);this.setMoveSelectedLabel(this.settings.moveSelectedLabel);this.setMoveAllLabel(this.settings.moveAllLabel);this.setRemoveSelectedLabel(this.settings.removeSelectedLabel);this.setRemoveAllLabel(this.settings.removeAllLabel);this.setMoveOnSelect(this.settings.moveOnSelect);this.setMoveOnDoubleClick(this.settings.moveOnDoubleClick);this.setPreserveSelectionOnMove(this.settings.preserveSelectionOnMove);this.setSelectedListLabel(this.settings.selectedListLabel);this.setNonSelectedListLabel(this.settings.nonSelectedListLabel);this.setHelperSelectNamePostfix(this.settings.helperSelectNamePostfix);this.setSelectOrMinimalHeight(this.settings.selectorMinimalHeight);h(this);this.setShowFilterInputs(this.settings.showFilterInputs);this.setNonSelectedFilter(this.settings.nonSelectedFilter);this.setSelectedFilter(this.settings.selectedFilter);this.setInfoText(this.settings.infoText);this.setInfoTextFiltered(this.settings.infoTextFiltered);this.setInfoTextEmpty(this.settings.infoTextEmpty);this.setFilterOnValues(this.settings.filterOnValues);this.setSortByInputOrder(this.settings.sortByInputOrder);this.setEventMoveOverride(this.settings.eventMoveOverride);this.setEventMoveAllOverride(this.settings.eventMoveAllOverride);this.setEventRemoveOverride(this.settings.eventRemoveOverride);this.setEventRemoveAllOverride(this.settings.eventRemoveAllOverride);this.element.hide().attr("disabled","disabled");c(this);b(this);x(this);if(this.settings.sortByInputOrder){k(this.elements.select2)}else{v(this.elements.select2)}this.sortIndex=this.element.find("option:selected").length;return this.element},setBootstrap2Compatible:function(z,y){this.settings.bootstrap2Compatible=z;if(z){this.container.removeClass("row").addClass("row-fluid bs2compatible");this.container.find(".box1, .box2").removeClass("col-md-6").addClass("span6");this.container.find(".clear1, .clear2").removeClass("btn-default btn-xs").addClass("btn-mini");this.container.find("input, select, ul").removeClass("form-control");this.container.find(".btn").removeClass("btn-default");this.container.find(".moveall > i, .move > i").removeClass("glyphicon glyphicon-arrow-right").addClass("icon-arrow-right");this.container.find(".removeall > i, .remove > i").removeClass("glyphicon glyphicon-arrow-left").addClass("icon-arrow-left")}else{this.container.removeClass("row-fluid bs2compatible").addClass("row");this.container.find(".box1, .box2").removeClass("span6").addClass("col-md-6");this.container.find(".clear1, .clear2").removeClass("btn-mini").addClass("btn-default btn-xs");this.container.find("input, select, ul").addClass("form-control");this.container.find(".btn").addClass("btn-default");this.container.find(".moveall > i, .move > i").removeClass("icon-arrow-right").addClass("glyphicon glyphicon-arrow-right");this.container.find(".removeall > i, .remove > i").removeClass("icon-arrow-left").addClass("glyphicon glyphicon-arrow-left")}if(y){b(this)}return this.element},setFilterTextClear:function(z,y){this.settings.filterTextClear=z;this.elements.filterClear1.html(z);this.elements.filterClear2.html(z);if(y){b(this)}return this.element},setFilterPlaceHolder:function(z,y){this.settings.filterPlaceHolder=z;this.elements.filterInput1.attr("placeholder",z);this.elements.filterInput2.attr("placeholder",z);if(y){b(this)}return this.element},setMoveSelectedLabel:function(z,y){this.settings.moveSelectedLabel=z;this.elements.moveButton.attr("title",z);if(y){b(this)}return this.element},setMoveAllLabel:function(z,y){this.settings.moveAllLabel=z;this.elements.moveAllButton.attr("title",z);if(y){b(this)}return this.element},setRemoveSelectedLabel:function(z,y){this.settings.removeSelectedLabel=z;this.elements.removeButton.attr("title",z);if(y){b(this)}return this.element},setRemoveAllLabel:function(z,y){this.settings.removeAllLabel=z;this.elements.removeAllButton.attr("title",z);if(y){b(this)}return this.element},setMoveOnSelect:function(A,z){if(r){A=true}this.settings.moveOnSelect=A;if(this.settings.moveOnSelect){this.container.addClass("moveonselect");var y=this;this.elements.select1.on("change",function(){t(y)});this.elements.select2.on("change",function(){u(y)})}else{this.container.removeClass("moveonselect");this.elements.select1.off("change");this.elements.select2.off("change")}if(z){b(this)}return this.element},setMoveOnDoubleClick:function(A,z){if(r){A=false}this.settings.moveOnDoubleClick=A;if(this.settings.moveOnDoubleClick){this.container.addClass("moveondoubleclick");var y=this;this.elements.select1.on("dblclick",function(){t(y)});this.elements.select2.on("dblclick",function(){u(y)})}else{this.container.removeClass("moveondoubleclick");this.elements.select1.off("dblclick");this.elements.select2.off("dblclick")}if(z){b(this)}return this.element},setPreserveSelectionOnMove:function(z,y){if(r){z=false}this.settings.preserveSelectionOnMove=z;if(y){b(this)}return this.element},setSelectedListLabel:function(z,y){this.settings.selectedListLabel=z;if(z){this.elements.label2.show().html(z)}else{this.elements.label2.hide().html(z)}if(y){b(this)}return this.element},setNonSelectedListLabel:function(z,y){this.settings.nonSelectedListLabel=z;if(z){this.elements.label1.show().html(z)}else{this.elements.label1.hide().html(z)}if(y){b(this)}return this.element},setHelperSelectNamePostfix:function(z,y){this.settings.helperSelectNamePostfix=z;if(z){this.elements.select1.attr("name",this.originalSelectName+z+"1");this.elements.select2.attr("name",this.originalSelectName+z+"2")}else{this.elements.select1.removeAttr("name");this.elements.select2.removeAttr("name")}if(y){b(this)}return this.element},setSelectOrMinimalHeight:function(A,z){this.settings.selectorMinimalHeight=A;var y=this.element.height();if(this.element.height()<A){y=A}this.elements.select1.height(y);this.elements.select2.height(y);if(z){b(this)}return this.element},setShowFilterInputs:function(z,y){if(!z){this.setNonSelectedFilter("");this.setSelectedFilter("");b(this);this.elements.filterInput1.hide();this.elements.filterInput2.hide()}else{this.elements.filterInput1.show();this.elements.filterInput2.show()}this.settings.showFilterInputs=z;if(y){b(this)}return this.element},setNonSelectedFilter:function(z,y){if(this.settings.showFilterInputs){this.settings.nonSelectedFilter=z;this.elements.filterInput1.val(z);if(y){b(this)}return this.element}},setSelectedFilter:function(z,y){if(this.settings.showFilterInputs){this.settings.selectedFilter=z;this.elements.filterInput2.val(z);if(y){b(this)}return this.element}},setInfoText:function(z,y){this.settings.infoText=z;if(z){this.elements.info1.show();this.elements.info2.show()}else{this.elements.info1.hide();this.elements.info2.hide()}if(y){b(this)}return this.element},setInfoTextFiltered:function(z,y){this.settings.infoTextFiltered=z;if(y){b(this)}return this.element},setInfoTextEmpty:function(z,y){this.settings.infoTextEmpty=z;if(y){b(this)}return this.element},setFilterOnValues:function(z,y){this.settings.filterOnValues=z;if(y){b(this)}return this.element},setSortByInputOrder:function(z,y){this.settings.sortByInputOrder=z;if(y){b(this)}return this.element},setEventMoveOverride:function(z,y){this.settings.eventMoveOverride=z;if(y){b(this)}return this.element},setEventMoveAllOverride:function(z,y){this.settings.eventMoveAllOverride=z;if(y){b(this)}return this.element},setEventRemoveOverride:function(z,y){this.settings.eventRemoveOverride=z;if(y){b(this)}return this.element},setEventRemoveAllOverride:function(z,y){this.settings.eventRemoveAllOverride=z;if(y){b(this)}return this.element},getContainer:function(){return this.container},refresh:function(y){h(this);if(!y){g(this,1);g(this,2)}else{e(this)}b(this);this.sortIndex=this.element.find("option:selected").length;x(this);if(this.settings.sortByInputOrder){k(this.elements.select2)}},destroy:function(){this.container.remove();this.element.show();f.data(this,"plugin_"+a,null);return this.element}};f.fn[a]=function(z){var y=arguments;if(z===i||typeof z==="object"){return this.each(function(){if(!f(this).is("select")){f(this).find("select").each(function(B,C){f(C).bootstrapDualListbox(z)})}else{if(!f.data(this,"plugin_"+a)){f.data(this,"plugin_"+a,new p(this,z))}}})}else{if(typeof z==="string"&&z[0]!=="_"&&z!=="init"){var A;this.each(function(){var B=f.data(this,"plugin_"+a);if(B instanceof p&&typeof B[z]==="function"){A=B[z].apply(B,Array.prototype.slice.call(y,1))}});return A!==i?A:this}}}})(jQuery,window,document);